 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>models.json - Discovered Model Manifest</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            margin: 0 auto;
            max-width: 900px;
            padding: 2em;
            color: #333;
        }
        h1, h2, h3 {
            font-weight: 600;
            color: #222;
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
        }
        code {
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            background-color: #f6f8fa;
            padding: 0.2em 0.4em;
            margin: 0;
            font-size: 85%;
            border-radius: 3px;
        }
        pre {
            background-color: #f6f8fa;
            padding: 16px;
            overflow: auto;
            border-radius: 5px;
            font-size: 85%;
        }
        pre code {
            padding: 0;
            margin: 0;
            font-size: 100%;
            background-color: transparent;
        }
        ul {
            padding-left: 20px;
        }
        li {
            margin-bottom: 0.5em;
        }
        .warning {
            background-color: #fffbdd;
            padding: 1em;
            border-left: 5px solid #ffb300;
        }
    </style>
</head>
<body>

    <h1><code>models.json</code> - Discovered Model Manifest</h1>
    <p>The <code>models.json</code> file acts as a simple, file-based manifest of the Ollama models that are available to the application. It is not intended to be edited manually; instead, it is automatically generated and serves as a cache of the models detected on the host system at a specific point in time.</p>

    <h2>1. File Structure</h2>
    <p>The file format is a straightforward JSON array of objects. Each object in the array represents a single Ollama model and contains one key.</p>
    <ul>
        <li><strong>Top-level structure</strong>: A JSON Array <code>[ ... ]</code>.</li>
        <li><strong>Object structure</strong>: Each element in the array is an object with a single key, <code>"name"</code>, whose value is the full name and tag of the model (e.g., <code>"llama3.1:latest"</code>). </li>
    </ul>

    <h3>Example Content</h3>
    <pre><code>[
    {
        "name": "llama3.1:latest"
    },
]</code></pre>

    <h2>2. Generation Process</h2>
    <p>This file is created and overwritten by the helper scripts included with the application. Its content is dynamic and reflects the state of the local Ollama installation whenever the generation script is run.</p>
    <ul>
        <li><strong>Generating Script</strong>: The file is generated by the <strong><code>get_models.py</code></strong> utility.</li>
        <li><strong>Trigger</strong>: The <code>get_models.py</code> script is called by the main <code>setup.py</code> script during the initial setup, or it can be run manually to refresh the list of available models.</li>
        <li><strong>Mechanism</strong>: The script calls the Ollama service (either via its Python library or the command-line interface) to get the current list of installed models and then writes that list to this file.</li>
    </ul>

    <h2>3. Usage in the Application</h2>
    <p>The main Flask application relies on this file to know which models it can offer to the user.</p>
    <ul>
        <li><strong>Loading</strong>: On startup, the <code>app.py</code> script reads <code>models.json</code> and loads its contents into a global variable named <code>MODELS</code>. The application will exit with a fatal error if this file is missing or contains invalid JSON.</li>
        <li><strong>API Exposure</strong>: The data is primarily used by the <code>/api/models</code> endpoint. This API returns the list of models to the frontend, which then populates the model selection dropdown in the user interface.</li>
        <li><strong>Filtering</strong>: The application also uses this list on the backend to filter out models containing restricted keywords (as defined in <code>config.json</code>) for non-admin users.</li>
    </ul>

    <h2>4. Manual Modification</h2>
    <div class="warning">
        <p><strong>Note:</strong> It is strongly advised not to edit this file manually. Any manual changes will be lost the next time the <code>get_models.py</code> or <code>setup.py</code> script is executed, as the file will be completely overwritten.</p>
    </div>

</body>
</html>